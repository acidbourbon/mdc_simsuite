Version 4
SHEET 1 9444 2468
WIRE 3760 592 3680 592
WIRE 3904 592 3824 592
WIRE 4096 592 4016 592
WIRE 4240 592 4160 592
WIRE 5392 592 5312 592
WIRE 5536 592 5456 592
WIRE 4528 624 4464 624
WIRE 4832 624 4592 624
WIRE 5120 624 4912 624
WIRE 3680 688 3680 592
WIRE 3760 688 3680 688
WIRE 3904 688 3904 592
WIRE 3904 688 3840 688
WIRE 4016 688 4016 592
WIRE 4096 688 4016 688
WIRE 4240 688 4240 592
WIRE 4240 688 4176 688
WIRE 5312 688 5312 592
WIRE 5392 688 5312 688
WIRE 5536 688 5536 592
WIRE 5536 688 5472 688
WIRE 4736 736 4672 736
WIRE 4864 736 4800 736
WIRE 4928 736 4864 736
WIRE 5056 736 4992 736
WIRE 3568 784 3328 784
WIRE 3680 784 3680 688
WIRE 3680 784 3648 784
WIRE 3760 784 3680 784
WIRE 4016 784 4016 688
WIRE 4096 784 4016 784
WIRE 5056 784 5056 736
WIRE 5120 784 5120 624
WIRE 5120 784 5056 784
WIRE 5168 784 5120 784
WIRE 5312 784 5312 688
WIRE 5312 784 5248 784
WIRE 5392 784 5312 784
WIRE 3856 800 3824 800
WIRE 3904 800 3904 688
WIRE 3904 800 3856 800
WIRE 4208 800 4160 800
WIRE 4240 800 4240 688
WIRE 4240 800 4208 800
WIRE 4464 800 4464 624
WIRE 4464 800 4240 800
WIRE 4528 800 4464 800
WIRE 4672 800 4672 736
WIRE 4672 800 4592 800
WIRE 5536 800 5536 688
WIRE 5536 800 5456 800
WIRE 5632 800 5536 800
WIRE 5696 800 5632 800
WIRE 3760 816 3728 816
WIRE 4096 816 4064 816
WIRE 5392 816 5360 816
WIRE 3328 832 3328 784
WIRE 3728 864 3728 816
WIRE 4064 864 4064 816
WIRE 4672 864 4672 800
WIRE 4736 864 4672 864
WIRE 4864 864 4864 736
WIRE 4864 864 4816 864
WIRE 4928 864 4864 864
WIRE 5056 864 5056 784
WIRE 5056 864 5008 864
WIRE 5360 864 5360 816
WIRE 3904 880 3904 800
WIRE 3920 880 3904 880
WIRE 4016 880 4016 784
WIRE 4016 880 4000 880
WIRE 3328 944 3328 912
FLAG 3856 800 out1
FLAG 4208 800 out2
FLAG 3728 864 0
FLAG 4064 864 0
FLAG 5632 800 vout
FLAG 5360 864 0
FLAG 3328 944 0
SYMBOL cap 3760 608 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName C8
SYMATTR Value {Cp}
SYMBOL res 3744 704 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R7
SYMATTR Value {Rp}
SYMBOL cap 4800 720 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C10
SYMATTR Value {TCC1}
SYMBOL cap 4992 720 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C11
SYMATTR Value {TCC2}
SYMBOL res 4720 880 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R9
SYMATTR Value {TCR1}
SYMBOL res 4912 880 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R10
SYMATTR Value {TCR2}
SYMBOL res 3552 800 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R14
SYMATTR Value {Z_in}
SYMBOL Opamps\\opamp 3792 736 R0
SYMATTR InstName U1
SYMATTR SpiceLine Aol=1000K
SYMATTR SpiceLine2 GBW=1000G
SYMBOL cap 4096 608 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName C5
SYMATTR Value {Cp}
SYMBOL res 4080 704 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R17
SYMATTR Value {Rp}
SYMBOL cap 5392 608 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName C9
SYMATTR Value {Cp}
SYMBOL res 5376 704 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R11
SYMATTR Value {Rp}
SYMBOL res 4016 864 R90
WINDOW 0 -42 58 VBottom 2
WINDOW 3 -36 55 VTop 2
SYMATTR InstName R8
SYMATTR Value {Rgc}
SYMBOL res 4816 640 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R1
SYMATTR Value 10k
SYMBOL Opamps\\opamp 4128 736 R0
SYMATTR InstName U2
SYMATTR SpiceLine Aol=1000K
SYMATTR SpiceLine2 GBW=1000G
SYMBOL Opamps\\opamp 5424 736 R0
SYMATTR InstName U3
SYMATTR SpiceLine Aol=1000K
SYMATTR SpiceLine2 GBW=1000G
SYMBOL Misc\\jumper 4560 736 R0
SYMATTR InstName X1
SYMBOL res 5264 768 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R2
SYMATTR Value 0.1
SYMBOL current 3328 832 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
WINDOW 3 -94 -82 Left 2
SYMATTR Value PWL file="sig_in.csv"
SYMATTR InstName I1
TEXT 4048 1040 Left 2 !.param tau pktime/2\n.param Cp 1p\n.param Rp tau/Cp
TEXT 3528 1040 Left 2 ;.param Z_in 50
TEXT 3504 496 Left 2 ;current amp + shaper 1+2
TEXT 4384 496 Left 2 ;tail cancellation
TEXT 5352 1176 Left 2 !.lib opamp.sub
TEXT 5232 496 Left 2 ;shaper 3
TEXT 4432 888 Left 2 ;bypass switch
TEXT 4144 1008 Left 2 ;shaping time
TEXT 3528 640 Left 2 ;PASTTREC\ninput\nimpedance
TEXT 5192 256 Left 2 !.tran 0 {transtop} 0 {timestep} startup
TEXT 5192 216 Left 2 !.include param.txt
TEXT 5192 296 Left 2 !.include trancmd.txt
TEXT 5496 168 Left 2 ;do not change this
TEXT 3712 1040 Left 2 ;<- controlled externally
TEXT 3536 1072 Left 2 ;(has no effect because we\nhave a defined input current)
TEXT 3528 984 Left 2 ;.param pktime 15e-9
TEXT 3832 984 Left 2 ;<- controlled externally
TEXT 3536 952 Left 2 ;peaking time
TEXT 4440 960 Left 2 ;.param TCR1 27k
TEXT 4696 960 Left 2 ;<- controlled externally
TEXT 4440 992 Left 2 ;.param TCC1 10.5p
TEXT 4696 992 Left 2 ;<- controlled externally
TEXT 4440 1024 Left 2 ;.param TCR2 20k
TEXT 4696 1024 Left 2 ;<- controlled externally
TEXT 4440 1056 Left 2 ;.param TCC2 0.9p
TEXT 4696 1056 Left 2 ;<- controlled externally
TEXT 3800 912 Left 2 !.param Rgc 12k/gain_correction
TEXT 3832 1008 Left 2 ;<- controlled externally
TEXT 3528 1008 Left 2 ;.param gain_correction 1
RECTANGLE Normal 5168 1136 4384 528 2
RECTANGLE Normal 5760 1136 5232 528 2
RECTANGLE Normal 4640 848 4432 576 2
RECTANGLE Normal 3504 1136 4304 528 2
RECTANGLE Normal 5760 368 5152 128 2
